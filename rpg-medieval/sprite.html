<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>RPG Medieval</title>

<style>
body {
    margin: 0;
    background: black;
    display: flex;
    justify-content: center;
    align-items: center;
    height: 100vh;
}

canvas {
    background: #87ceeb;
    image-rendering: pixelated;
    border: 2px solid black;
}
</style>
</head>
<body>

<canvas id="game" width="800" height="400"></canvas>

<script>
const canvas = document.getElementById("game");
const ctx = canvas.getContext("2d");

/* =====================
   IMÃGENES
===================== */
const idleImage = new Image();
idleImage.src = "./Sprites/Knight/Idle.png";

const runImage = new Image();
runImage.src = "./Sprites/Knight/Run.png";

/* =====================
   SPRITE DATA
===================== */
const FRAME_WIDTH = 128;
const FRAME_HEIGHT = 128;
const IDLE_FRAMES = 6;
const RUN_FRAMES = 8;

let currentFrame = 0;
let frameTimer = 0;
const FRAME_SPEED = 8;

/* =====================
   PLAYER
===================== */
const player = {
    x: 336,
    y: 200,
    speed: 3,
    moving: false,
    direction: 1 // 1 = derecha, -1 = izquierda
};

/* =====================
   INPUT
===================== */
const keys = {};

window.addEventListener("keydown", e => keys[e.key] = true);
window.addEventListener("keyup", e => keys[e.key] = false);

/* =====================
   LOOP
===================== */
function loop() {
    update();
    draw();
    requestAnimationFrame(loop);
}

/* =====================
   UPDATE
===================== */
function update() {
    player.moving = false;

    if (keys["ArrowRight"]) {
        player.x += player.speed;
        player.direction = 1;
        player.moving = true;
    }

    if (keys["ArrowLeft"]) {
        player.x -= player.speed;
        player.direction = -1;
        player.moving = true;
    }

    frameTimer++;
    if (frameTimer >= FRAME_SPEED) {
        frameTimer = 0;
        currentFrame++;
        const maxFrames = player.moving ? RUN_FRAMES : IDLE_FRAMES;
        if (currentFrame >= maxFrames) currentFrame = 0;
    }
}

/* =====================
   DRAW
===================== */
function draw() {
    ctx.clearRect(0, 0, canvas.width, canvas.height);

    const sprite = player.moving ? runImage : idleImage;

    ctx.save();
    ctx.scale(player.direction, 1);

    ctx.drawImage(
        sprite,
        currentFrame * FRAME_WIDTH,
        0,
        FRAME_WIDTH,
        FRAME_HEIGHT,
        player.direction === 1 ? player.x : -player.x - FRAME_WIDTH,
        player.y,
        FRAME_WIDTH,
        FRAME_HEIGHT
    );

    ctx.restore();
}

/* =====================
   START
===================== */
loop();
</script>

</body>
</html>

